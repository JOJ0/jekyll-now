---
layout: post
title: Building MIDI controllers 1 - The Matrix
comments: true
published: 2018-11-23
image: /images/2018-11-17-midictrl1/IMG_XXXX.jpg
draft: true
---

MIDI controllers are not the most complicated things to build and program. If you have your MIDI basics covered and have a little experience with Arduino-type microcontrollers it's just a matter of capturing an inputdevice (button, knob, ...) into your microcontroller and sending some bytes out via a serial port, which MIDI essentially is.

There is a lot about building basic MIDI controllers on the net already so I won't cover that, but give an overview of what helped me to get going last year:

  * [This](https://www.youtube.com/watch?v=0L7WAMFWSgY&index=80&t=0s&list=PLcHqk0rpp8br1wTI-LeNKtxVmEKB1YT8O) is probably the best explanation of how MIDI circuits really work from an electrical point of view.
  * [This basic MIDI controllers tutorial](https://www.youtube.com/watch?v=DXhxdsGREsU) is from the same guy but unfortunately he doesn't explain much how it actually works, you won't learn coding with this one.
  * [Video series ](https://www.youtube.com/playlist?list=PL8ANKYeWEXshCLOS9sFfcQNigYXEb1Ps6) in german language for absolute beginners without any Arduino experience. Also he doesn't use any libraries but explains how to do everything from scratch.
  * [This video](https://www.youtube.com/watch?v=aVf_el4N0tI&t=54s) is quite nice, he's using a Teensy microcontroller which has MIDI over USB by default

Speaking of: just to get one slightly dissapointing thing straight from the beginning: Most of the common Arduino types are not capable of natively spitting out MIDI on their USB ports, but I'm going to show a hardware-hackish approach to still make it work. A few Arduinos have native USB capabilities and can make use of the [MIDIUSB library](https://github.com/arduino-libraries/MIDIUSB) , but that's usually the type of Arduino you don't have at hand at the right moment. The only one's that have USB-MIDI out of the box are the Teensy's but they cost a little more, if you don't want any hassle go get one! [This is the website of the founder](https://www.pjrc.com/teensy/), you'll find excellent documentation there.


## The input device

This is going to be my chosen input device, a button matrix out of a 1995 landline phone, built by the company Kapsch, model TP80.

<div class="clearfix" style="margin-bottom: 20px;">
{% include thumb.html filename='/images/2018-11-17-midictrl1/matrixmidi-01.jpg' caption='I got these phone parts out of a spare parts collection' width="49%" float="left" %}
{% include thumb.html filename='/images/2018-11-17-midictrl1/matrixmidi-02.jpg' caption='There was another PCB connected to the actual buttons PCB that had to be desoldered first' width="49%" float="right" %}
</div>


So wtf is a matrix? [This guy](https://www.youtube.com/watch?v=DlW77pAyDx4&t=1s&list=PLcHqk0rpp8br1wTI-LeNKtxVmEKB1YT8O&index=5) explains it quite well, just ignore the voltage ladder for now. [The german speaking guy over here](https://www.youtube.com/watch?v=vaqzTHOvpH8&t=1604s&list=PLcHqk0rpp8br1wTI-LeNKtxVmEKB1YT8O&index=10), altough a bit more advanced, is explaining useful things too. He uses a button matrix out of an old chipcard terminal.

Personally my first experience with a button/keyboard matrix was the tiny 80s keyboard featured in [one of my blog posts]({% post_url 2017-12-26-yamaha-ps-1 %}). I found a lot of information about a similar keyboard on [this website](http://weltenschule.de/TableHooters/Yamaha_PS-2.html). The site owner even has put together a whole [FAQ](http://weltenschule.de/TableHooters/WarrantyVoidFAQ.htm) about circuit bending and especially hacking keyboards. Scroll down a little (well a lot, it's long) and look for headlines containing keyboard matrix. Deadly useful information there!!! 



### Measuring

<div class="pic_row_3">
  <div class="pic_left">
    {% include thumb.html filename='/images/2018-11-17-midictrl1/matrixmidi-03.jpg' caption='The top 3 connections are labeled by a letter X, the bottom 4 with a letter Y. Ignore the red wire on the very bottom.' %}
  </div>
  <div class="pic_middle">
    {% include thumb.html filename='/images/2018-11-17-midictrl1/matrixmidi-04.jpg' caption='No buttons pressed - no connections, but when button 1 is pressed X1 to Y1 show a connection.' %}
  </div>
  <div class="pic_right">
    {% include thumb.html filename='/images/2018-11-17-midictrl1/matrixmidi-05.jpg' caption='X2 to Y1 is connected when button 2 is pressed' %}
  </div>
</div>

<div class="pic_row_3">
  <div class="pic_left">
    {% include thumb.html filename='/images/2018-11-17-midictrl1/matrixmidi-06.jpg' caption='X3 to Y1 is connected when button 3 is pressed' %}
  </div>
  <div class="pic_middle">
    {% include thumb.html filename='/images/2018-11-17-midictrl1/matrixmidi-07.jpg' caption='X1 to Y2 is connected when button 4 is pressed' %}
  </div>
  <div class="pic_right">
    {% include thumb.html filename='/images/2018-11-17-midictrl1/matrixmidi-08.jpg' caption='X2 to Y2 is connected when button 5 is pressed' %}
  </div>
</div>


I guess you see where this is going by now. If not, go back and rewatch the two youtube videos posted above.

Before I started with writing code, I did some fitting to the case I was planning to put it in. I found this in my parent's basement. Eventually I built it myself during my apprenticeship back in the 90ies. It should have become a little battery powered radio but as fas as I remember, due to time reasons we never even started to build the electronics.

<div class="pic_row_3">
  <div class="pic_left">
    {% include thumb.html filename='/images/2018-11-17-midictrl1/matrixmidi-xx.jpg' caption='' %}
  </div>
  <div class="pic_middle">
    {% include thumb.html filename='/images/2018-11-17-midictrl1/matrixmidi-xx.jpg' caption='' %}
  </div>
  <div class="pic_right">
    {% include thumb.html filename='/images/2018-11-17-midictrl1/matrixmidi-xx.jpg' caption='' %}
  </div>
</div>


3 pics in a row template here:

<div class="pic_row_3">
  <div class="pic_left">
    {% include thumb.html filename='/images/2018-11-17-midictrl1/matrixmidi-xx.jpg' caption='' %}
  </div>
  <div class="pic_middle">
    {% include thumb.html filename='/images/2018-11-17-midictrl1/matrixmidi-xx.jpg' caption='' %}
  </div>
  <div class="pic_right">
    {% include thumb.html filename='/images/2018-11-17-midictrl1/matrixmidi-xx.jpg' caption='' %}
  </div>
</div>




gallery here

<div class="photo-gallery-frame clearfix" style="margin-top: 20px; margin-bottom: ;">
  <ul class="photo-gallery-list">
    {% for photo in site.midictrl1 limit:100 offset:30 %}
    <li>
      <a href="{{ photo.url | prepend: site.baseurl }}" name="{{ photo.title }}">
        <img src="{{ photo.image-path|remove: ".jpg"| append: '-th'|append: ".jpg" }}" alt="{{ photo.caption }}" />
      </a>
    </li>
    {% endfor %}
  </ul>
</div>



note:
first:
yes it's high: 0 0
last:
yes it's high: 2 3



<a name="videos 1"></a>

blinking LEDs video here:

{% include youtube.html id="xxxxxxx" url_append="?start=2490" width="100%" %}
text unter youtube
<br><br>

### Getting materials


[20 pin inline socket](https://www.musikding.de/20-Pin-inline-socket)<br>
